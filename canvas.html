<html>
<head>
    <title></title>
    <script type="text/javascript">

        var context;
        var palette = Array();
        var buffer = Array();
        var width;
        var height;

        function init()
        {
             initPalette();

             element = document.getElementById('canvas');
             width = element.width;
             height = element.height;

             context = element.getContext("2d");
             context.fillRect(0, 0, width, height);
             
             update();
        }

        function initPalette()
        {
            for(i = 0; i < 64; i++)
            {
                palette[i] = rgbToColor((i << 2), 0, 0);
                palette[i + 64] = rgbToColor(255, (i << 2), 0);
                palette[i + 128] = rgbToColor(255, 255, (i << 2));
                palette[i + 192] = rgbToColor(255, 255, 255);
            }
        }

        function rgbToColor(r, g, b)
        {
            color = 0;

            color |= (r << 16);
            color |= (g << 8);
            color |= (b);

            return color;            
        }

        function colorToString(color)
        {
            return "#" + ("00000" + (color).toString(16)).slice(-6);
        }

        function update()
        {
            for(x = 0; x < width; x++)
                drawPixel(x, height - 1, palette[randomValue(palette.length - 1)]);

            requestAnimFrame(function(){
                update();
            });
        }

        function drawPixel(x, y, color)
        {
            context.fillStyle = colorToString(color);
            context.fillRect(x, y, 1, 1);
        }

        function randomValue(max)
        {
            return Math.round(Math.random() * max);
        }

        window.onload = function(){
            init();
        };

        window.requestAnimFrame = (function(callback){
            return window.requestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame ||
            window.oRequestAnimationFrame ||
            window.msRequestAnimationFrame ||
            function(callback){
                window.setTimeout(callback, 1000 / 60);
            };
        })();
 
    </script>
</head>
<body>
<canvas id="canvas" width="200" height="200"></canvas>
</body>
</html>